# 统一授权认证服务接口说明

## 第三方APP注册

## 统一用户注册

## 统一用户登录

## 获取授权码

### 请求URL

```http
GET https://cs.api.qcloud.com/oauth2/test/authorize?response_type=code&client_id=CLIENTID&scope=SCOPE&state=RANDOM_STRING&redirect_uri=REDIRECT_URI&userid=USERID&platform=PLATFORM
```

### 参数说明

| 参数名 | 描述 |
| :--- | :--- |
| response_type | 响应类型，固定为 “code” |
| client_id | 客户端appid, 在[第三方APP注册](#第三方APP注册)的时候可以获取到 |
| scope | 用户授权的作用域，使用逗号（,）分隔 |
| state | 随机字符串，服务会原样返回 |
| redirect_uri | 重定向uri，要求必须是在[第三方APP注册](#第三方APP注册)的时候填写的uri的子级 |
| userid | 用户ID |
| platform | 客户端平台 <br> web -- 表示当前请求客户端为Web应用 <br> android - 表示当前客户端是android应用

### 返回说明

```json
{
    "error_code": 0,
    "error_msg": "ok",
    "code": "CODE",
    "state": "xyz"
}
```

| 参数名      | 类型    | 描述   |
|:-----------|:-------| :----------|
| error_code | int    | 错误码   |
| error_msg  | string | 错误信息    |
| code    | string | 授权码 |
| state | string | 随机字符串，请求时的内容原样返回 |

## 获取access_token

### 请求URL

```http
POST https://cs.api.qcloud.com/oauth2/test/access_token?grant_type=authorization_code&client_id=CLIENTID&client_secret=SECRET&code=AUTH_CODE
```

### 参数说明

| 参数名 | 描述 |
| :--- | :--- |
| grant_type | 授权类型，固定为 “authorization_code” |
| client_id | 客户端appid, 在[第三方APP注册](#第三方APP注册)的时候可以获取到 |
| client_secret | APP Secret, 在[第三方APP注册](#第三方APP注册)的时候可以获取到 |
| code | 授权码，在[获取授权码](#获取授权码)步骤中获取到的code |

### 返回说明

```json
{
    "error_code": 0,
    "error_msg": "ok",
    "access_token":"ACCESS_TOKEN",
    "expires_in":7200,
    "refresh_token":"REFRESH_TOKEN",
    "openid":"OPENID",
    "scope":"SCOPE"
}
```

| 参数名      | 类型    | 描述   |
|:-----------|:-------| :----------|
| error_code | int    | 错误码   |
| error_msg  | string | 错误信息    |
| access_token   | string | 接口调用凭证 |
| expires_in | int | access_token接口调用凭证超时时间，单位（秒）|
| refresh_token | string | 用户刷新access_token |
| openid | string | 授权用户唯一标识 |
| scope | string | 用户授权的作用域，使用逗号（,）分隔 |

## 刷新access_token有效期

### 请求URL

```http
POST https://cs.api.qcloud.com/oauth2/test/refresh_token?grant_type=refresh_token&client_id=CLIENTID&refresh_token=REFRESH_TOKEN
```

### 参数说明

| 参数名 | 描述 |
| :--- | :--- |
| grant_type | 授权类型，固定为 "refresh_token" |
| client_id | 客户端appid, 在[第三方APP注册](#第三方APP注册)的时候可以获取到 |
| refresh_token | 刷新票据有效期，在[获取授权码](#获取授权码)步骤中获取到的code |

### 返回说明

```json
{
    "error_code": 0,
    "error_msg": "ok",
    "access_token":"ACCESS_TOKEN",
    "expires_in":7200,
    "refresh_token":"REFRESH_TOKEN",
    "openid":"OPENID",
    "scope":"SCOPE"
}
```

| 参数名      | 类型    | 描述   |
|:-----------|:-------| :----------|
| error_code | int    | 错误码   |
| error_msg  | string | 错误信息    |
| access_token   | string | 接口调用凭证 |
| expires_in | int | access_token接口调用凭证超时时间，单位（秒）|
| refresh_token | string | 用户刷新access_token |
| openid | string | 授权用户唯一标识 |
| scope | string | 用户授权的作用域，使用逗号（,）分隔 |